<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- home mit groovy version 2.4.3; hftl with 2.3.7 (?) -->

<project default="all" name="Create Runnable Jar for Project CitationTools">
	<!--this file was created by Eclipse Runnable JAR Export Wizard-->
	<!--ANT 1.7 is required                                        -->

	<property name="user.name" value="Andreas Thor"/>
	<property name="build.dir" value="./build"/>
	<property name="build.name" value="CitedReferencesExplorer.jar"/>
	<property name="fat.name" value="CitedReferencesExplorerFull.jar"/>
	<property name="jnlp" value="CitedReferencesExplorer.jnlp"/>
	<property name="src.dir" value="./src/"/>
	<property name="bin.dir" value="./bin/"/>
	<property name="lib.dir" value="./lib/"/>
	<property name="html.dir" value="./html/"/>
		
		
	<!-- Specify if release or test deployment -->	
	<property name="deployRELEASE.dir" value="www1_thor/crexplorer/"/>
	<property name="deploy.dir" value="www1_thor/citationtest/"/>
	
	<!-- Specify if running from home or from HfTL -->	
	<property name="plugin.dir" value="C:/Program Files (other)/eclipse-jee-mars-2-win32/plugins/org.codehaus.groovy_2.4.3.xx-201601131831-e45"/>
	<property name="pluginHFTL.dir"  value="C:/Programme (other)/eclipse luna 32bit/plugins/org.codehaus.groovy_2.3.7.xx-201411061335-e44-RELEASE"/>
	


	<!-- clean,create_jws_jar,create_fat_jar,sign,deploy -->
	<target name="all" depends="clean,create_jws_jar,create_fat_jar,sign,deploy"></target>

	<target name="clean">
		<delete dir="${build.dir}"/>
	</target>



	<target name="create_jws_jar">
		<jar destfile="${build.dir}/${build.name}">
			<manifest>
				<attribute name="Main-Class" value="cre.CitedReferencesExplorer" />
				<attribute name="Class-Path" value="lib/groovy-all-2.4.3.jar lib/hamcrest-core-1.3.jar lib/jcommon-1.0.23.jar lib/jfreechart-1.0.19-experimental.jar lib/jfreechart-1.0.19-swt.jar lib/jfreechart-1.0.19.jar lib/jfreesvg-2.0.jar lib/junit-4.11.jar lib/orsoncharts-1.4-eval-nofx.jar lib/orsonpdf-1.6-eval.jar lib/servlet.jar lib/swtgraphics2d.jar lib/opencsv-2.3.jar lib/simmetrics_jar_v1_6_2_d07_02_07.jar lib/bsf-2.4.0.jar lib/ivy-2.3.0-sources.jar lib/ivy-2.3.0.jar lib/servlet-api-2.4.jar"/>  
				<attribute name="Permissions" value="all-permissions"/>
				<attribute name="Application-Name" value="Cited References Explorer"/>
			</manifest>
			<fileset dir="${bin.dir}" />
			<!-- <fileset dir="C:/Users/thor/.groovy/greclipse/global_dsld_support" /> -->
            <!-- <fileset dir="C:/Users/Andreas/.groovy/greclipse/global_dsld_support"/> -->
			<fileset dir="${plugin.dir}/plugin_dsld_support" /> 
		</jar>
		<delete dir="${build.dir}/lib" />
		<mkdir dir="${build.dir}/lib" />
		<copy todir="${build.dir}/lib">
			<fileset dir="${plugin.dir}/lib"/>
		</copy>
<!--
		<copy file="${plugin.dir}/lib/groovy-all-2.3.7.jar" todir="${build.dir}/lib" />
		<copy file="${plugin.dir}/lib/bsf-2.4.0.jar" todir="${build.dir}/lib" />
		<copy file="${plugin.dir}/lib/ivy-2.3.0-sources.jar" todir="${build.dir}/lib" />
		<copy file="${plugin.dir}/lib/ivy-2.3.0.jar" todir="${build.dir}/lib" />
		<copy file="${plugin.dir}/lib/servlet-api-2.4.jar" todir="${build.dir}/lib" />
-->	
	
		<copy todir="${build.dir}/lib" flatten="true">
			<fileset dir="${lib.dir}"/>
		</copy>
	</target>

<!-- jar="${build.dir}/${build.name}" -->
	<target name="sign">
		<signjar keystore="res/AndreasThor3.keystore"  alias="AndreasThor" storepass="${SignPW}">
		  <path>
		    <fileset dir="${build.dir}" includes="**/*.jar" />
		  </path>
		</signjar>
	</target>

	
	<target name="deploy">
		<scp trust="true" todir="thor:${ftpPW}@seru01.hft-leipzig.de:/home/thor/home/${deploy.dir}">
		  	<fileset dir="${build.dir}"/>	 
			<fileset dir="${html.dir}"/>
			<fileset dir="." includes="${jnlp} CRE64.png CRE32.png" />
		</scp>
	</target>
	
	
	<target name="deploy_copy">
		<copy todir="${deploy.dir}">
			<fileset dir="${build.dir}"/>
		</copy>
		<copy todir="${deploy.dir}">
			<fileset dir="${html.dir}"/>
		</copy>
		<copy file="${jnlp}" todir="${deploy.dir}"/>
		<copy file="CRE64.png" todir="${deploy.dir}"/>
		<copy file="CRE32.png" todir="${deploy.dir}"/>
	</target>

	<!-- must be executed after create_ws_jar because it referes to the build/lib directory!!! -->
    <target name="create_fat_jar">
        <jar destfile="${build.dir}/${fat.name}">
            <manifest>
                <attribute name="Main-Class" value="org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader"/>
                <attribute name="Rsrc-Main-Class" value="cre.CitedReferencesExplorer"/>
                <attribute name="Class-Path" value="."/>
                <attribute name="Rsrc-Class-Path" value="./ groovy-all-2.4.3.jar bsf-2.4.0.jar ivy-2.3.0-sources.jar ivy-2.3.0.jar servlet-api-2.4.jar opencsv-2.3.jar simmetrics_jar_v1_6_2_d07_02_07.jar hamcrest-core-1.3.jar jcommon-1.0.23.jar jfreechart-1.0.19-experimental.jar jfreechart-1.0.19-swt.jar jfreechart-1.0.19.jar jfreesvg-2.0.jar junit-4.11.jar orsoncharts-1.4-eval-nofx.jar orsonpdf-1.6-eval.jar servlet.jar swtgraphics2d.jar"/>
            </manifest>
            <zipfileset src="jar-in-jar-loader.zip"/>
        	<fileset dir="${bin.dir}" />
        	
        	<!--
            <zipfileset dir="${plugin.dir}\lib" includes="groovy-all-2.3.7.jar"/>
        	<zipfileset dir="${plugin.dir}\lib" includes="bsf-2.4.0.jar"/>
            <zipfileset dir="${plugin.dir}\lib" includes="ivy-2.3.0-sources.jar"/>
            <zipfileset dir="${plugin.dir}\lib" includes="ivy-2.3.0.jar"/>
            <zipfileset dir="${plugin.dir}\lib" includes="servlet-api-2.4.jar"/>
            -->
            <!-- <fileset dir="C:/Users/thor/.groovy/greclipse/global_dsld_support"/> -->
            <fileset dir="${plugin.dir}/plugin_dsld_support/"/>
        	<zipfileset dir="${build.dir}/lib" />
        	<!--
            <zipfileset dir="D:\Dev\CRE\lib" includes="opencsv-2.3.jar"/>
            <zipfileset dir="D:\Dev\CRE\lib" includes="simmetrics_jar_v1_6_2_d07_02_07.jar"/>
            <zipfileset dir="D:\Dev\CRE\lib\jchart" includes="hamcrest-core-1.3.jar"/>
            <zipfileset dir="D:\Dev\CRE\lib\jchart" includes="jcommon-1.0.23.jar"/>
            <zipfileset dir="D:\Dev\CRE\lib\jchart" includes="jfreechart-1.0.19-experimental.jar"/>
            <zipfileset dir="D:\Dev\CRE\lib\jchart" includes="jfreechart-1.0.19-swt.jar"/>
            <zipfileset dir="D:\Dev\CRE\lib\jchart" includes="jfreechart-1.0.19.jar"/>
            <zipfileset dir="D:\Dev\CRE\lib\jchart" includes="jfreesvg-2.0.jar"/>
            <zipfileset dir="D:\Dev\CRE\lib\jchart" includes="junit-4.11.jar"/>
            <zipfileset dir="D:\Dev\CRE\lib\jchart" includes="orsoncharts-1.4-eval-nofx.jar"/>
            <zipfileset dir="D:\Dev\CRE\lib\jchart" includes="orsonpdf-1.6-eval.jar"/>
            <zipfileset dir="D:\Dev\CRE\lib\jchart" includes="servlet.jar"/>
            <zipfileset dir="D:\Dev\CRE\lib\jchart" includes="swtgraphics2d.jar"/>
            -->
        </jar>
    </target>	
	


</project>
